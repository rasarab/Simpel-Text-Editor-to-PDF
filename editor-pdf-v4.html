<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Text Editor → PDF</title>
  <style>
    :root{
      --bg:#0f1216; --panel:#171b22; --accent:#4cc9f0; --text:#e6e9ef; --muted:#9aa4b2; --border:#2a2f38;
    }
    body{margin:0; background:var(--bg); color:var(--text); font:14px/1.6 system-ui, sans-serif;}
    header{padding:16px 20px; border-bottom:1px solid var(--border); background:var(--panel); position:sticky; top:0; z-index:10; display:flex; gap:16px; flex-wrap:wrap; align-items:center;}
    header h1{font-size:16px; margin:0; color:var(--accent)}
    .controls{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .controls label{display:flex; flex-direction:column; font-size:12px; color:var(--muted)}
    .controls input,.controls select{background:#0c0f13; color:var(--text); border:1px solid var(--border); padding:8px 10px; border-radius:8px; min-width:140px;}
    .btn{background:#0c0f13; color:var(--text); border:1px solid var(--border); padding:8px 10px; border-radius:8px; cursor:pointer;}
    .btn.primary{background:var(--accent); color:#0b0e12; border-color:transparent; font-weight:600}
    .toolbar{display:flex; flex-wrap:wrap; gap:8px; padding:10px 20px; border-bottom:1px solid var(--border); background:#12161c; position:sticky; top:56px; z-index:9;}
    .editor-wrap{max-width:900px; margin:20px auto; padding:0 20px 40px}
    #title{width:100%; background:#0c0f13; color:var(--text); border:1px solid var(--border); padding:12px 14px; border-radius:10px; font-size:18px; margin-bottom:12px;}
    #editor{background:#0c0f13; border:1px solid var(--border); border-radius:12px; min-height:600px; padding:18px; outline:none;}
    #editor:empty:before{content:"Mulai mengetik di sini…"; color:var(--muted)}
    footer{padding:16px 20px; border-top:1px solid var(--border); background:var(--panel); color:var(--muted); text-align:center;}
    footer .donate{margin-top:10px;}
    footer .donate a{display:inline-block; background:#ffdd00; color:#000; padding:10px 16px; border-radius:8px; font-weight:600; text-decoration:none;}
  </style>
  <!-- CDN jsPDF & html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  <header>
    <h1>Text Editor → PDF</h1>
    <div class="controls">
      <label>Judul dokumen <input id="docTitle" type="text"/></label>
      <label>Nama file <input id="fileName" type="text" value="dokumen.pdf"/></label>
      <label>Ukuran kertas
        <select id="paperSize">
          <option value="a4">A4</option>
          <option value="letter">Letter</option>
          <option value="legal">Legal</option>
        </select>
      </label>
      <label>Margin (mm) <input id="marginMm" type="number" value="15"/></label>
      <label>Tema PDF
        <select id="pdfTheme">
          <option value="light" selected>Light</option>
          <option value="dark">Dark</option>
        </select>
      </label>
      <button id="exportBtn" class="btn primary">Export PDF</button>
    </div>
  </header>

  <div class="toolbar">
    <button class="btn" data-cmd="bold"><b>B</b></button>
    <button class="btn" data-cmd="italic"><i>I</i></button>
    <button class="btn" data-cmd="underline"><u>U</u></button>
    <button class="btn" data-cmd="formatBlock" data-value="h2">H2</button>
    <button class="btn" data-cmd="insertUnorderedList">• List</button>
    <button class="btn" data-cmd="justifyCenter">Center</button>
    <button class="btn" id="clearBtn">Clear</button>
  </div>

  <div class="editor-wrap">
    <input id="title" type="text" placeholder="Judul halaman"/>
    <div id="editor" contenteditable="true">
      <p>Tulis konten kamu di sini…</p>
    </div>
  </div>

  <footer>
    Dibuat ringan—cukup buka file ini di browser, edit, lalu export PDF.
    <div class="donate">
      <a href="https://lynk.id/rasarab/s/kn8vBoX" target="_blank">☕ Buy Me a Coffee</a>
    </div>
    <div style="margin-top:12px; font-size:13px; color:#e6e9ef;">
      Di mata lalat, dunia ini luas dan penuh kemungkinan ♥ RASARAB
    </div>
  </footer>

  <script>
    // Toolbar actions
    document.querySelectorAll('.toolbar .btn[data-cmd]').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const cmd = btn.getAttribute('data-cmd');
        const val = btn.getAttribute('data-value') || null;
        document.execCommand(cmd,false,val);
      });
    });
    document.getElementById('clearBtn').addEventListener('click', ()=>{
      if(confirm('Kosongkan konten editor?')) document.getElementById('editor').innerHTML='';
    });

    // Export to PDF
    document.getElementById('exportBtn').addEventListener('click', async ()=>{
      const fileName = document.getElementById('fileName').value || 'dokumen.pdf';
      const paper = document.getElementById('paperSize').value;
      const marginMm = parseFloat(document.getElementById('marginMm').value) || 15;
      const docTitle = document.getElementById('docTitle').value || '';
      const theme = document.getElementById('pdfTheme').value;

      const sizes={a4:[210,297],letter:[215.9,279.4],legal:[215.9,355.6]};
      const pageSize=sizes[paper]||sizes.a4;

      const temp=document.createElement('div');
      temp.style.width='800px';
      temp.style.padding='20px';
      temp.style.fontFamily='serif';
      temp.style.lineHeight='1.6';
      temp.style.background = theme==='dark' ? '#000' : '#fff';
      temp.style.color = theme==='dark' ? '#fff' : '#000';
      temp.innerHTML=`${docTitle?'<h1>'+docTitle+'</h1>':''}${document.getElementById('title').value?'<h2>'+document.getElementById('title').value+'</h2>':''}<div>${document.getElementById('editor').innerHTML}</div>`;
      document.body.appendChild(temp);

      const canvas=await html2canvas(temp,{scale:2});
      const imgData=canvas.toDataURL('image/png');
      const pdf=new window.jspdf.jsPDF({unit:'mm',format:pageSize});
      const pageW=pageSize[0],pageH=pageSize[1];
      const usableW=pageW-2*marginMm,usableH=pageH-2*marginMm;
      const pxW=canvas.width,pxH=canvas.height;
      const mmPerPx=25.4/96;
      const imgMmW=pxW*mmPerPx,imgMmH=pxH*mmPerPx;
      const scale=Math.min(usableW/imgMmW,usableH/imgMmH);
      const drawW=imgMmW*scale,drawH=imgMmH*scale;

      pdf.addImage(imgData,'PNG',(pageW-drawW)/2,marginMm,drawW,drawH);
      pdf.save(fileName);

      document.body.removeChild(temp);
    });
  </script>
</body